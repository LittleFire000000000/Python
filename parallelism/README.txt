This is very rough and not yet tested or finished.
